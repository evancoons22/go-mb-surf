{{define "map.html"}}
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
                       integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
                       crossorigin=""/>
<!-- Make sure you put this AFTER Leaflet's CSS -->

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
        integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
        crossorigin=""></script>

<style>
    #map { height: 400px; }
</style>

<div id="map"></div>


<script type="text/javascript">
    // check if localmapdata was sent by the go server
    var map = L.map('map').setView([33.86, 238.4171], 13);
    var lat = 33.86;
    var lon = 238.4171;

    L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
    }).addTo(map);

    L.marker([33.86, 238.4171]).addTo(map)
        .bindPopup('A pretty CSS popup.<br> Easily customizable.')
        .openPopup();


    // json parse this local map data
    console.log("map", {{.LocalMapData}});
    let localMapData = {{.LocalMapData}};

    popup = L.popup();
    
    function onMapClick(e) {
        popup
            .setLatLng(e.latlng)
            .setContent("Lat, Lon : " + e.latlng.toString())
            .openOn(map);
    }

    map.on('click', onMapClick);
    // console log the .LocalMapData here to see what it

</script>
{{end}}
